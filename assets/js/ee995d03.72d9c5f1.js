"use strict";(self.webpackChunkpersonalpage=self.webpackChunkpersonalpage||[]).push([[43],{9341:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>l});var n=s(5893),o=s(1151);const a={slug:"picoctf-2014-part3",title:"picoCTF 2014 part 3: Steve's List",authors:"csressel"},r="Steve\u2019s List",i={permalink:"/blog/picoctf-2014-part3",source:"@site/blog/2014-12-01-picoctf-part3.md",title:"picoCTF 2014 part 3: Steve's List",description:"Summary",date:"2014-12-01T00:00:00.000Z",formattedDate:"December 1, 2014",tags:[],readingTime:3.75,hasTruncateMarker:!0,authors:[{name:"Clifford",url:"https://github.com/CSRessel",imageURL:"/img/csressel-xs.jpg",key:"csressel"}],frontMatter:{slug:"picoctf-2014-part3",title:"picoCTF 2014 part 3: Steve's List",authors:"csressel"},unlisted:!1,prevItem:{title:"10 minute moments",permalink:"/blog/many-minutes-few-moments"},nextItem:{title:"picoCTF 2014 part 2: secure_page_service",permalink:"/blog/picoctf-2014-part2"}},c={authorsImageUrls:[void 0]},l=[{value:"Summary",id:"summary",level:2}];function p(e){const t={code:"code",h2:"h2",p:"p",...(0,o.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,n.jsxs)(t.p,{children:["Hash extension allows us to enter whatever cookies we choose, without knowledge of the secret, and still pass the website\u2019s checks. Since the cookie is unserialized, we can inject arbitrary php objects into the server. By injecting a Post object, we know it\u2019s destroy method will be called. This method has been redefined to output the Post\u2019s fields in HTML comments after parsing them with the class Filter. The Filter operates by running the given text through preg_replace calls with stored params for match and substitution. As we have injected the object, we have complete control over these stored params, and can thus call the preg_replace with the \u2018e\u2019 flag, allowing us to do arbitrary command execution. By catting the necessary file at ",(0,n.jsx)(t.code,{children:"/home/daedalus/flag.txt"}),", and substituting all of the Post\u2019s text with the file\u2019s contents, we can print the file\u2019s contents in an HTML comment, and thus get the flag."]})]})}function h(e={}){const{wrapper:t}={...(0,o.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(p,{...e})}):p(e)}},1151:(e,t,s)=>{s.d(t,{Z:()=>i,a:()=>r});var n=s(7294);const o={},a=n.createContext(o);function r(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);